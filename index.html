<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marcador PÃ¡del</title>

<style>
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont;
    background: #111;
    color: white;
    text-align: center;
  }

  h1 {
    margin: 10px 0;
  }

  .container {
    display: flex;
    justify-content: space-around;
    margin-top: 20px;
  }

  .team {
    width: 45%;
    border: 2px solid #444;
    border-radius: 12px;
    padding: 10px;
  }

  .serve {
    font-size: 2.5rem;
    height: 50px;
  }

  .big {
    font-size: 3.5rem;
    margin: 5px 0;
  }

  button {
    font-size: 1.4rem;
    padding: 12px;
    margin: 6px;
    width: 90%;
  }

  .tie {
    display: none;
  }

  .footer {
    margin-top: 10px;
  }

  .points {
    font-size: 2rem;
    margin: 10px 0;
  }
</style>
</head>

<body>

<h1>ðŸŽ¾ Marcador PÃ¡del</h1>

<div class="container">

  <div class="team">
    <div id="serveA" class="serve">ðŸŽ¾ A1</div>
    <h2>Pareja A</h2>

    <div>Puntos</div>
    <div id="pointsA" class="points">0</div>

    <div>Sets</div>
    <div id="setsA" class="big">0</div>

    <div>Juegos</div>
    <div id="gamesA" class="big">0</div>

    <div id="tieA" class="big tie">0</div>

    <button onclick="point('A')">+ Punto</button>
    <button id="btnTieA" class="tie" onclick="addTie('A')">+ Tie</button>
  </div>

  <div class="team">
    <div id="serveB" class="serve" style="opacity:0.3">ðŸŽ¾ B1</div>
    <h2>Pareja B</h2>

    <div>Puntos</div>
    <div id="pointsB" class="points">0</div>

    <div>Sets</div>
    <div id="setsB" class="big">0</div>

    <div>Juegos</div>
    <div id="gamesB" class="big">0</div>

    <div id="tieB" class="big tie">0</div>

    <button onclick="point('B')">+ Punto</button>
    <button id="btnTieB" class="tie" onclick="addTie('B')">+ Tie</button>
  </div>

</div>

<div class="footer">
  <button onclick="resetMatch()">ðŸ”„ Reset partido</button>
</div>

<script>
let setsA = 0, setsB = 0;
let gamesA = 0, gamesB = 0;
let tieA = 0, tieB = 0;
let tieBreak = false;

// Puntos del juego actual (0=0, 1=15, 2=30, 3=40, 4=Ventaja)
let pointsA = 0, pointsB = 0;

let serverIndex = 0;

/* ---------- PUNTOS ---------- */
function point(team) {
  if (tieBreak) {
    addTie(team);
    return;
  }

  if (team === 'A') {
    // Ventaja â†’ Juego
    if (pointsA === 4) {
      addGame('A');
      return;
    }

    // Deuce â†’ Ventaja
    if (pointsA === 3 && pointsB === 3) {
      pointsA = 4;
      update();
      return;
    }

    // Rival tenÃ­a ventaja â†’ volver a Deuce
    if (pointsB === 4) {
      pointsB = 3;
      update();
      return;
    }

    // ProgresiÃ³n normal
    pointsA++;
    // Si llega a 40 y el rival tiene menos de 40, gana el juego
    if (pointsA === 4 && pointsB < 3) {
      addGame('A');
      return;
    }
  } else {
    // Ventaja â†’ Juego
    if (pointsB === 4) {
      addGame('B');
      return;
    }

    // Deuce â†’ Ventaja
    if (pointsB === 3 && pointsA === 3) {
      pointsB = 4;
      update();
      return;
    }

    // Rival tenÃ­a ventaja â†’ volver a Deuce
    if (pointsA === 4) {
      pointsA = 3;
      update();
      return;
    }

    // ProgresiÃ³n normal
    pointsB++;
    // Si llega a 40 y el rival tiene menos de 40, gana el juego
    if (pointsB === 4 && pointsA < 3) {
      addGame('B');
      return;
    }
  }
  
  update();
}

/* ---------- JUEGOS ---------- */
function addGame(team) {
  if (tieBreak) return;

  team === 'A' ? gamesA++ : gamesB++;
  
  // Reset puntos del juego
  pointsA = pointsB = 0;
  
  nextServer();
  update();

  if ((gamesA >= 6 || gamesB >= 6) && Math.abs(gamesA - gamesB) >= 2) {
    winSet();
    return;
  }

  if (gamesA === 6 && gamesB === 6) {
    startTieBreak();
  }
}

/* ---------- TIE ---------- */
function startTieBreak() {
  tieBreak = true;
  pointsA = pointsB = 0;
  showTie(true);
}

function addTie(team) {
  team === 'A' ? tieA++ : tieB++;

  let total = tieA + tieB;
  if (total === 1 || total % 2 === 1) nextServer();

  update();

  if ((tieA >= 7 || tieB >= 7) && Math.abs(tieA - tieB) >= 2) {
    winSet();
  }
}

/* ---------- SET ---------- */
function winSet() {
  if (gamesA > gamesB || tieA > tieB) setsA++;
  else setsB++;

  gamesA = gamesB = tieA = tieB = 0;
  pointsA = pointsB = 0;
  tieBreak = false;
  showTie(false);
  update();
}

/* ---------- SAQUE ---------- */
function nextServer() {
  serverIndex = (serverIndex + 1) % 4;
}

function updateServe() {
  const a = document.getElementById('serveA');
  const b = document.getElementById('serveB');
  a.style.opacity = b.style.opacity = 0.3;

  if (serverIndex === 0) { a.innerText = "ðŸŽ¾ A1"; a.style.opacity = 1; }
  if (serverIndex === 1) { b.innerText = "ðŸŽ¾ B1"; b.style.opacity = 1; }
  if (serverIndex === 2) { a.innerText = "ðŸŽ¾ A2"; a.style.opacity = 1; }
  if (serverIndex === 3) { b.innerText = "ðŸŽ¾ B2"; b.style.opacity = 1; }
}

/* ---------- UI ---------- */
function showTie(v) {
  tieAEl.style.display = tieBEl.style.display =
  btnTieA.style.display = btnTieB.style.display = v ? 'block' : 'none';
}

function labelPoints(v) {
  return ['0', '15', '30', '40', 'A'][v];
}

function update() {
  pointsAEl.innerText = labelPoints(pointsA);
  pointsBEl.innerText = labelPoints(pointsB);
  setsAEl.innerText = setsA;
  setsBEl.innerText = setsB;
  gamesAEl.innerText = gamesA;
  gamesBEl.innerText = gamesB;
  tieAEl.innerText = tieA;
  tieBEl.innerText = tieB;
  updateServe();
}

function resetMatch() {
  setsA = setsB = gamesA = gamesB = tieA = tieB = 0;
  pointsA = pointsB = 0;
  tieBreak = false;
  serverIndex = 0;
  showTie(false);
  update();
}

const pointsAEl = document.getElementById('pointsA');
const pointsBEl = document.getElementById('pointsB');
const setsAEl = document.getElementById('setsA');
const setsBEl = document.getElementById('setsB');
const gamesAEl = document.getElementById('gamesA');
const gamesBEl = document.getElementById('gamesB');
const tieAEl = document.getElementById('tieA');
const tieBEl = document.getElementById('tieB');
const btnTieA = document.getElementById('btnTieA');
const btnTieB = document.getElementById('btnTieB');

update();
</script>

</body>
</html>
